(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{799:function(t,s,a){"use strict";a.r(s);var n=a(79),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"volatility取证分析工具"}},[t._v("Volatility取证分析工具 "),s("a",{staticClass:"header-anchor",attrs:{href:"#volatility取证分析工具"}},[t._v("#")])]),t._v(" "),s("h2",{attrs:{id:"关于工具"}},[t._v("关于工具 "),s("a",{staticClass:"header-anchor",attrs:{href:"#关于工具"}},[t._v("#")])]),t._v(" "),s("h3",{attrs:{id:"简单描述"}},[t._v("简单描述 "),s("a",{staticClass:"header-anchor",attrs:{href:"#简单描述"}},[t._v("#")])]),t._v(" "),s("p",[t._v("Volatility是一款开源内存取证框架，能够对导出的内存镜像进行分析，通过获取内核数据结构，使用插件获取内存的详细情况以及系统的运行状态。")]),t._v(" "),s("p",[t._v("特点：")]),t._v(" "),s("ul",[s("li",[t._v("开源：Python编写，易于和基于python的主机防御框架集成。")]),t._v(" "),s("li",[t._v("支持多平台：Windows，Mac，Linux全支持")]),t._v(" "),s("li",[t._v("易于扩展：通过插件来扩展Volatility的分析能力")])]),t._v(" "),s("h3",{attrs:{id:"项目地址"}},[t._v("项目地址 "),s("a",{staticClass:"header-anchor",attrs:{href:"#项目地址"}},[t._v("#")])]),t._v(" "),s("p",[t._v("https://github.com/volatilityfoundation/volatility")]),t._v(" "),s("h3",{attrs:{id:"kali安装"}},[t._v("Kali安装 "),s("a",{staticClass:"header-anchor",attrs:{href:"#kali安装"}},[t._v("#")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("sudo apt-get install volatility\nvolatility -h\n# 部分报错可能kali版本过低\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h3",{attrs:{id:"流程图"}},[t._v("流程图 "),s("a",{staticClass:"header-anchor",attrs:{href:"#流程图"}},[t._v("#")])]),t._v(" "),s("p",[s("img",{attrs:{src:"http://peiqi.tech/wgpsec-ctf/ctfwiki/wgp-misc-1-1.png",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"常用模块"}},[t._v("常用模块 "),s("a",{staticClass:"header-anchor",attrs:{href:"#常用模块"}},[t._v("#")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[s("strong",[t._v("插件名称")])]),t._v(" "),s("th",[s("strong",[t._v("功能")])])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("amcache")]),t._v(" "),s("td",[t._v("查看AmCache应用程序痕迹信息")])]),t._v(" "),s("tr",[s("td",[t._v("apihooks")]),t._v(" "),s("td",[t._v("检测内核及进程的内存空间中的API hook")])]),t._v(" "),s("tr",[s("td",[t._v("atoms")]),t._v(" "),s("td",[t._v("列出会话及窗口站atom表")])]),t._v(" "),s("tr",[s("td",[t._v("atomscan")]),t._v(" "),s("td",[t._v("Atom表的池扫描(Pool scanner)")])]),t._v(" "),s("tr",[s("td",[t._v("auditpol")]),t._v(" "),s("td",[t._v("列出注册表HKLMSECURITYPolicyPolAdtEv的审计策略信息")])]),t._v(" "),s("tr",[s("td",[t._v("bigpools")]),t._v(" "),s("td",[t._v("使用BigPagePoolScanner转储大分页池(big page pools)")])]),t._v(" "),s("tr",[s("td",[t._v("bioskbd")]),t._v(" "),s("td",[t._v("从实时模式内存中读取键盘缓冲数据(早期电脑可以读取出BIOS开机密码)")])]),t._v(" "),s("tr",[s("td",[t._v("cachedump")]),t._v(" "),s("td",[t._v("获取内存中缓存的域帐号的密码哈希")])]),t._v(" "),s("tr",[s("td",[t._v("callbacks")]),t._v(" "),s("td",[t._v("打印全系统通知例程")])]),t._v(" "),s("tr",[s("td",[t._v("clipboard")]),t._v(" "),s("td",[t._v("提取Windows剪贴板中的内容")])]),t._v(" "),s("tr",[s("td",[t._v("cmdline")]),t._v(" "),s("td",[t._v("显示进程命令行参数")])]),t._v(" "),s("tr",[s("td",[t._v("cmdscan")]),t._v(" "),s("td",[t._v("提取执行的命令行历史记录（扫描_COMMAND_HISTORY信息）")])]),t._v(" "),s("tr",[s("td",[t._v("connections")]),t._v(" "),s("td",[t._v("打印系统打开的网络连接(仅支持Windows XP 和2003)")])]),t._v(" "),s("tr",[s("td",[t._v("connscan")]),t._v(" "),s("td",[t._v("打印TCP连接信息")])]),t._v(" "),s("tr",[s("td",[t._v("consoles")]),t._v(" "),s("td",[t._v("提取执行的命令行历史记录（扫描_CONSOLE_INFORMATION信息）")])]),t._v(" "),s("tr",[s("td",[t._v("crashinfo")]),t._v(" "),s("td",[t._v("提取崩溃转储信息")])]),t._v(" "),s("tr",[s("td",[t._v("deskscan")]),t._v(" "),s("td",[t._v("tagDESKTOP池扫描(Poolscaner)")])]),t._v(" "),s("tr",[s("td",[t._v("devicetree")]),t._v(" "),s("td",[t._v("显示设备树信息")])]),t._v(" "),s("tr",[s("td",[t._v("dlldump")]),t._v(" "),s("td",[t._v("从进程地址空间转储动态链接库")])]),t._v(" "),s("tr",[s("td",[t._v("dlllist")]),t._v(" "),s("td",[t._v("打印每个进程加载的动态链接库列表")])]),t._v(" "),s("tr",[s("td",[t._v("driverirp")]),t._v(" "),s("td",[t._v("IRP hook驱动检测")])]),t._v(" "),s("tr",[s("td",[t._v("drivermodule")]),t._v(" "),s("td",[t._v("关联驱动对象至内核模块")])]),t._v(" "),s("tr",[s("td",[t._v("driverscan")]),t._v(" "),s("td",[t._v("驱动对象池扫描")])]),t._v(" "),s("tr",[s("td",[t._v("dumpcerts")]),t._v(" "),s("td",[t._v("提取RAS私钥及SSL公钥")])]),t._v(" "),s("tr",[s("td",[t._v("dumpfiles")]),t._v(" "),s("td",[t._v("提取内存中映射或缓存的文件")])]),t._v(" "),s("tr",[s("td",[t._v("dumpregistry")]),t._v(" "),s("td",[t._v("转储内存中注册表信息至磁盘")])]),t._v(" "),s("tr",[s("td",[t._v("editbox")]),t._v(" "),s("td",[t._v("查看Edit编辑控件信息 (Listbox正在实验中)")])]),t._v(" "),s("tr",[s("td",[t._v("envars")]),t._v(" "),s("td",[t._v("显示进程的环境变量")])]),t._v(" "),s("tr",[s("td",[t._v("eventhooks")]),t._v(" "),s("td",[t._v("打印Windows事件hook详细信息")])]),t._v(" "),s("tr",[s("td",[t._v("evtlogs")]),t._v(" "),s("td",[t._v("提取Windows事件日志（仅支持XP/2003)")])]),t._v(" "),s("tr",[s("td",[t._v("filescan")]),t._v(" "),s("td",[t._v("提取文件对象（file objects）池信息")])]),t._v(" "),s("tr",[s("td",[t._v("gahti")]),t._v(" "),s("td",[t._v("转储用户句柄（handle）类型信息")])]),t._v(" "),s("tr",[s("td",[t._v("gditimers")]),t._v(" "),s("td",[t._v("打印已安装的GDI计时器(timers)及回调(callbacks)")])]),t._v(" "),s("tr",[s("td",[t._v("gdt")]),t._v(" "),s("td",[t._v("显示全局描述符表(Global Deor Table)")])]),t._v(" "),s("tr",[s("td",[t._v("getservicesids")]),t._v(" "),s("td",[t._v("获取注册表中的服务名称并返回SID信息")])]),t._v(" "),s("tr",[s("td",[t._v("getsids")]),t._v(" "),s("td",[t._v("打印每个进程的SID信息")])]),t._v(" "),s("tr",[s("td",[t._v("handles")]),t._v(" "),s("td",[t._v("打印每个进程打开的句柄的列表")])]),t._v(" "),s("tr",[s("td",[t._v("hashdump")]),t._v(" "),s("td",[t._v("转储内存中的Windows帐户密码哈希(LM/NTLM)")])]),t._v(" "),s("tr",[s("td",[t._v("hibinfo")]),t._v(" "),s("td",[t._v("转储休眠文件信息")])]),t._v(" "),s("tr",[s("td",[t._v("hivedump")]),t._v(" "),s("td",[t._v("打印注册表配置单元信息")])]),t._v(" "),s("tr",[s("td",[t._v("hivelist")]),t._v(" "),s("td",[t._v("打印注册表配置单元列表")])]),t._v(" "),s("tr",[s("td",[t._v("hivescan")]),t._v(" "),s("td",[t._v("注册表配置单元池扫描")])]),t._v(" "),s("tr",[s("td",[t._v("hpakextract")]),t._v(" "),s("td",[t._v("从HPAK文件（Fast Dump格式）提取物理内存数据")])]),t._v(" "),s("tr",[s("td",[t._v("hpakinfo")]),t._v(" "),s("td",[t._v("查看HPAK文件属性及相关信息")])]),t._v(" "),s("tr",[s("td",[t._v("idt")]),t._v(" "),s("td",[t._v("显示中断描述符表(Interrupt Deor Table)")])]),t._v(" "),s("tr",[s("td",[t._v("iehistory")]),t._v(" "),s("td",[t._v("重建IE缓存及访问历史记录")])]),t._v(" "),s("tr",[s("td",[t._v("imagecopy")]),t._v(" "),s("td",[t._v("将物理地址空间导出原生DD镜像文件")])]),t._v(" "),s("tr",[s("td",[t._v("imageinfo")]),t._v(" "),s("td",[t._v("查看/识别镜像信息")])]),t._v(" "),s("tr",[s("td",[t._v("impscan")]),t._v(" "),s("td",[t._v("扫描对导入函数的调用")])]),t._v(" "),s("tr",[s("td",[t._v("joblinks")]),t._v(" "),s("td",[t._v("打印进程任务链接信息")])]),t._v(" "),s("tr",[s("td",[t._v("kdbgscan")]),t._v(" "),s("td",[t._v("搜索和转储潜在KDBG值")])]),t._v(" "),s("tr",[s("td",[t._v("kpcrscan")]),t._v(" "),s("td",[t._v("搜索和转储潜在KPCR值")])]),t._v(" "),s("tr",[s("td",[t._v("ldrmodules")]),t._v(" "),s("td",[t._v("检测未链接的动态链接DLL")])]),t._v(" "),s("tr",[s("td",[t._v("lsadump")]),t._v(" "),s("td",[t._v("从注册表中提取LSA密钥信息（已解密）")])]),t._v(" "),s("tr",[s("td",[t._v("machoinfo")]),t._v(" "),s("td",[t._v("转储Mach-O 文件格式信息")])]),t._v(" "),s("tr",[s("td",[t._v("malfind")]),t._v(" "),s("td",[t._v("查找隐藏的和插入的代码")])]),t._v(" "),s("tr",[s("td",[t._v("mbrparser")]),t._v(" "),s("td",[t._v("扫描并解析潜在的主引导记录(MBR)")])]),t._v(" "),s("tr",[s("td",[t._v("memdump")]),t._v(" "),s("td",[t._v("转储进程的可寻址内存")])]),t._v(" "),s("tr",[s("td",[t._v("memmap")]),t._v(" "),s("td",[t._v("打印内存映射")])]),t._v(" "),s("tr",[s("td",[t._v("messagehooks")]),t._v(" "),s("td",[t._v("桌面和窗口消息钩子的线程列表")])]),t._v(" "),s("tr",[s("td",[t._v("mftparser")]),t._v(" "),s("td",[t._v("扫描并解析潜在的MFT条目")])]),t._v(" "),s("tr",[s("td",[t._v("moddump")]),t._v(" "),s("td",[t._v("转储内核驱动程序到可执行文件的示例")])]),t._v(" "),s("tr",[s("td",[t._v("modscan")]),t._v(" "),s("td",[t._v("内核模块池扫描")])]),t._v(" "),s("tr",[s("td",[t._v("modules")]),t._v(" "),s("td",[t._v("打印加载模块的列表")])]),t._v(" "),s("tr",[s("td",[t._v("multiscan")]),t._v(" "),s("td",[t._v("批量扫描各种对象")])]),t._v(" "),s("tr",[s("td",[t._v("mutantscan")]),t._v(" "),s("td",[t._v("对互斥对象池扫描")])]),t._v(" "),s("tr",[s("td",[t._v("notepad")]),t._v(" "),s("td",[t._v("查看记事本当前显示的文本")])]),t._v(" "),s("tr",[s("td",[t._v("objtypescan")]),t._v(" "),s("td",[t._v("扫描窗口对象类型对象")])]),t._v(" "),s("tr",[s("td",[t._v("patcher")]),t._v(" "),s("td",[t._v("基于页面扫描的补丁程序内存")])]),t._v(" "),s("tr",[s("td",[t._v("poolpeek")]),t._v(" "),s("td",[t._v("可配置的池扫描器插件")])]),t._v(" "),s("tr",[s("td",[t._v("printkey")]),t._v(" "),s("td",[t._v("打印注册表项及其子项和值")])]),t._v(" "),s("tr",[s("td",[t._v("privs")]),t._v(" "),s("td",[t._v("显示进程权限")])]),t._v(" "),s("tr",[s("td",[t._v("procdump")]),t._v(" "),s("td",[t._v("进程转储到一个可执行文件示例")])]),t._v(" "),s("tr",[s("td",[t._v("pslist")]),t._v(" "),s("td",[t._v("按照EPROCESS列表打印所有正在运行的进程")])]),t._v(" "),s("tr",[s("td",[t._v("psscan")]),t._v(" "),s("td",[t._v("进程对象池扫描")])]),t._v(" "),s("tr",[s("td",[t._v("pstree")]),t._v(" "),s("td",[t._v("以树型方式打印进程列表")])]),t._v(" "),s("tr",[s("td",[t._v("psxview")]),t._v(" "),s("td",[t._v("查找带有隐藏进程的所有进程列表")])]),t._v(" "),s("tr",[s("td",[t._v("qemuinfo")]),t._v(" "),s("td",[t._v("转储Qemu 信息")])]),t._v(" "),s("tr",[s("td",[t._v("raw2dmp")]),t._v(" "),s("td",[t._v("将物理内存原生数据转换为windbg崩溃转储格式")])]),t._v(" "),s("tr",[s("td",[t._v("screenshot")]),t._v(" "),s("td",[t._v("基于GDI Windows的虚拟屏幕截图保存")])]),t._v(" "),s("tr",[s("td",[t._v("servicediff")]),t._v(" "),s("td",[t._v("Windows服务列表(ala Plugx)")])]),t._v(" "),s("tr",[s("td",[t._v("sessions")]),t._v(" "),s("td",[t._v("_MM_SESSION_SPACE的详细信息列表(用户登录会话)")])]),t._v(" "),s("tr",[s("td",[t._v("shellbags")]),t._v(" "),s("td",[t._v("打印Shellbags信息")])]),t._v(" "),s("tr",[s("td",[t._v("shimcache")]),t._v(" "),s("td",[t._v("解析应用程序兼容性Shim缓存注册表项")])]),t._v(" "),s("tr",[s("td",[t._v("shutdowntime")]),t._v(" "),s("td",[t._v("从内存中的注册表信息获取机器关机时间")])]),t._v(" "),s("tr",[s("td",[t._v("sockets")]),t._v(" "),s("td",[t._v("打印已打开套接字列表")])]),t._v(" "),s("tr",[s("td",[t._v("sockscan")]),t._v(" "),s("td",[t._v("TCP套接字对象池扫描")])]),t._v(" "),s("tr",[s("td",[t._v("ssdt")]),t._v(" "),s("td",[t._v("显示SSDT条目")])]),t._v(" "),s("tr",[s("td",[t._v("strings")]),t._v(" "),s("td",[t._v("物理到虚拟地址的偏移匹配(需要一些时间，带详细信息)")])]),t._v(" "),s("tr",[s("td",[t._v("svcscan")]),t._v(" "),s("td",[t._v("Windows服务列表扫描")])]),t._v(" "),s("tr",[s("td",[t._v("symlinkscan")]),t._v(" "),s("td",[t._v("符号链接对象池扫描")])]),t._v(" "),s("tr",[s("td",[t._v("thrdscan")]),t._v(" "),s("td",[t._v("线程对象池扫描")])]),t._v(" "),s("tr",[s("td",[t._v("threads")]),t._v(" "),s("td",[t._v("调查_ETHREAD 和_KTHREADs")])]),t._v(" "),s("tr",[s("td",[t._v("timeliner")]),t._v(" "),s("td",[t._v("创建内存中的各种痕迹信息的时间线")])]),t._v(" "),s("tr",[s("td",[t._v("timers")]),t._v(" "),s("td",[t._v("打印内核计时器及关联模块的DPC")])]),t._v(" "),s("tr",[s("td",[t._v("truecryptmaster")]),t._v(" "),s("td",[t._v("恢复TrueCrypt 7.1a主密钥")])]),t._v(" "),s("tr",[s("td",[t._v("truecryptpassphrase")]),t._v(" "),s("td",[t._v("查找并提取TrueCrypt密码")])]),t._v(" "),s("tr",[s("td",[t._v("truecryptsummary")]),t._v(" "),s("td",[t._v("TrueCrypt摘要信息")])]),t._v(" "),s("tr",[s("td",[t._v("unloadedmodules")]),t._v(" "),s("td",[t._v("打印卸载的模块信息列表")])]),t._v(" "),s("tr",[s("td",[t._v("userassist")]),t._v(" "),s("td",[t._v("打印注册表中UserAssist相关信息")])]),t._v(" "),s("tr",[s("td",[t._v("userhandles")]),t._v(" "),s("td",[t._v("转储用户句柄表")])]),t._v(" "),s("tr",[s("td",[t._v("vaddump")]),t._v(" "),s("td",[t._v("转储VAD数据为文件")])]),t._v(" "),s("tr",[s("td",[t._v("vadinfo")]),t._v(" "),s("td",[t._v("转储VAD信息")])]),t._v(" "),s("tr",[s("td",[t._v("vadtree")]),t._v(" "),s("td",[t._v("以树形方式显示VAD树信息")])]),t._v(" "),s("tr",[s("td",[t._v("vadwalk")]),t._v(" "),s("td",[t._v("显示遍历VAD树")])]),t._v(" "),s("tr",[s("td",[t._v("vboxinfo")]),t._v(" "),s("td",[t._v("转储Virtualbox信息（虚拟机）")])]),t._v(" "),s("tr",[s("td",[t._v("verinfo")]),t._v(" "),s("td",[t._v("打印PE镜像中的版本信息")])]),t._v(" "),s("tr",[s("td",[t._v("vmwareinfo")]),t._v(" "),s("td",[t._v("转储VMware VMSS/VMSN 信息")])]),t._v(" "),s("tr",[s("td",[t._v("volshell")]),t._v(" "),s("td",[t._v("内存镜像中的shell")])]),t._v(" "),s("tr",[s("td",[t._v("windows")]),t._v(" "),s("td",[t._v("打印桌面窗口(详细信息)")])]),t._v(" "),s("tr",[s("td",[t._v("wintree")]),t._v(" "),s("td",[t._v("Z顺序打印桌面窗口树")])]),t._v(" "),s("tr",[s("td",[t._v("wndscan")]),t._v(" "),s("td",[t._v("池扫描窗口站")])]),t._v(" "),s("tr",[s("td",[t._v("yarascan")]),t._v(" "),s("td",[t._v("以Yara签名扫描进程或内核内存")])])])]),t._v(" "),s("h3",{attrs:{id:"常用命令"}},[t._v("常用命令 "),s("a",{staticClass:"header-anchor",attrs:{href:"#常用命令"}},[t._v("#")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[s("strong",[t._v("功能")])]),t._v(" "),s("th",[s("strong",[t._v("命令行及参数")])])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("查看进程列表")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 pslist")])]),t._v(" "),s("tr",[s("td",[t._v("查看进程列表（树形）")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 pstree")])]),t._v(" "),s("tr",[s("td",[t._v("查看进程列表(psx视图)")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 psxview")])]),t._v(" "),s("tr",[s("td",[t._v("查看网络通讯连接")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 netscan")])]),t._v(" "),s("tr",[s("td",[t._v("查看加载的动态链接库")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 dlllist")])]),t._v(" "),s("tr",[s("td",[t._v("查看SSDT表")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 ssdt")])]),t._v(" "),s("tr",[s("td",[t._v("查看UserAssist痕迹")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 userassist")])]),t._v(" "),s("tr",[s("td",[t._v("查看ShimCache痕迹")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 shimcache")])]),t._v(" "),s("tr",[s("td",[t._v("查看ShellBags")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 shellbags")])]),t._v(" "),s("tr",[s("td",[t._v("查看服务列表")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 svcscan")])]),t._v(" "),s("tr",[s("td",[t._v("查看Windows帐户hash")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 hashdump")])]),t._v(" "),s("tr",[s("td",[t._v("查看最后关机时间")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 shutdowntime")])]),t._v(" "),s("tr",[s("td",[t._v("查看IE历史记录")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 iehistory")])]),t._v(" "),s("tr",[s("td",[t._v("提取注册表数据")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 dumpregistry")])]),t._v(" "),s("tr",[s("td",[t._v("解析MFT记录")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 mftparser")])]),t._v(" "),s("tr",[s("td",[t._v("导出MFT记录,恢复文件")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 mftparser –output-file=mftverbose.txt -D mftoutput")])]),t._v(" "),s("tr",[s("td",[t._v("获取TrueCrypt密钥信息")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 truecryptmaster")])]),t._v(" "),s("tr",[s("td",[t._v("获取TrueCrypt密码信息")]),t._v(" "),s("td",[t._v("Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 truecryptpassphras")])])])]),t._v(" "),s("h2",{attrs:{id:"参考文章"}},[t._v("参考文章 "),s("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[t._v("#")])]),t._v(" "),s("p",[s("a",{attrs:{href:"http://www.secist.com/archives/2076.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("DumpIt.exe 进程"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.freebuf.com/articles/system/26763.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Volatility基本介绍"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.cnblogs.com/sesefadou/p/11804566.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("基本命令"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://blog.csdn.net/Kevinhanser/article/details/80013033?utm_source=blogxgwz5",target:"_blank",rel:"noopener noreferrer"}},[t._v("组合命令"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.cnblogs.com/0x4D75/p/11161822.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("进阶命令"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1378638",target:"_blank",rel:"noopener noreferrer"}},[t._v("基础题型和基本取证"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.freebuf.com/sectool/124690.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("利用Volatility进行Windows内存取证分析"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.sohu.com/a/350272484_100124117",target:"_blank",rel:"noopener noreferrer"}},[t._v("windows取证"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://blog.csdn.net/cqupt_chen/article/details/7771417",target:"_blank",rel:"noopener noreferrer"}},[t._v("内存取证"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"从题目学习volatility取证"}},[t._v("从题目学习Volatility取证 "),s("a",{staticClass:"header-anchor",attrs:{href:"#从题目学习volatility取证"}},[t._v("#")])]),t._v(" "),s("h3",{attrs:{id:"四川省高校ctf大赛-安恒杯-play-with-cookie"}},[t._v("四川省高校CTF大赛[安恒杯] - Play with Cookie "),s("a",{staticClass:"header-anchor",attrs:{href:"#四川省高校ctf大赛-安恒杯-play-with-cookie"}},[t._v("#")])]),t._v(" "),s("p",[t._v("文件描述：得到了master key file 的和靶机镜像文件，需要找到里面的flag")]),t._v(" "),s("h4",{attrs:{id:"了解基本架构"}},[t._v("了解基本架构 "),s("a",{staticClass:"header-anchor",attrs:{href:"#了解基本架构"}},[t._v("#")])]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" volatility "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" Cookie.raw imageinfo\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-1.jpg",alt:""}})]),t._v(" "),s("p",[t._v("得到的关键信息")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Win7SP1x86\nmage date and time : 2020-02-11 12:11:51 UTC+0000\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("关键看Suggested Profile(s)项，这里是工具判断该镜像的架构，同时也会提供相应架构的命令用于分析该镜像，本题中可能性最大的架构是Win7SP1x86，然后在调用命令时加上--profile=Win7SP1x86就可以了")]),t._v(" "),s("h4",{attrs:{id:"敏感信息获取"}},[t._v("敏感信息获取 "),s("a",{staticClass:"header-anchor",attrs:{href:"#敏感信息获取"}},[t._v("#")])]),t._v(" "),s("p",[s("code",[t._v("获取所有使用的进程号的信息")])]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" volatility "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" Cookie.raw "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--profile")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Win7SP1x86 pslist　"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" pslist.txt　\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-2.jpg",alt:""}})]),t._v(" "),s("p",[s("code",[t._v("查看一下是否含有flag文件")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('volatility -f Cookie.raw --profile=Win7SP1x86 filescan | grep "doc|docx|rtf"\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('volatility -f Cookie.raw --profile=Win7SP1x86 filescan | grep "jpg|jpeg|png|tif|gif|bmp"\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("volatility -f Cookie.raw --profile=Win7SP1x86 filescan | grep 'flag|ctf'\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('volatility -f Cookie.raw --profile=Win7SP1x86 filescan | grep "Desktop"\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("C:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("home"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("kali"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("桌面"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" volatility "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" Cookie.raw "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--profile")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Win7SP1x86 filescan "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Desktop"')]),t._v("\nVolatility Foundation Volatility Framework "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.6")]),t._v("\n0x000000003e423038      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Cookie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("AppData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Roaming"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Start Menu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Programs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Accessories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Accessibility"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop.ini\n0x000000003e486038      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Cookie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("desktop.ini\n0x000000003e4ebb08      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Public"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("desktop.ini\n0x000000003e51c3a0      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("ProgramData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Start Menu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Programs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Accessories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("System Tools"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop.ini\n0x000000003e5789e0      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" R--rw- "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Cookie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop\n0x000000003e5f1668      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Cookie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop\n0x000000003e628400      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("root"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("AppData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Roaming"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("SendTo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop.ini\n0x000000003e663160      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("assembly"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop.ini\n0x000000003e66a228      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" RW-rw- "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Cookie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("WIN-I0396FOVLRF-20200211-121148.raw\n0x000000003e671d28      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--r-d "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Cookie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("DumpIt.exe\n0x000000003e69ef80      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("ProgramData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Start Menu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Programs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Accessories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Accessibility"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop.ini\n0x000000003e6a9d28      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Public"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop\n0x000000003e6aacb8      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("ProgramData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Start Menu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Programs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Accessories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop.ini\n0x000000003e6ff950      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--r-d "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Cookie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("DumpIt.exe\n0x000000003e70d308      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Media"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop.ini\n0x000000003e73af80      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Cookie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("AppData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Roaming"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Start Menu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Programs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Maintenance"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop.ini\n0x000000003e90e718      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Cookie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("AppData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Roaming"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Start Menu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Programs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Accessories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("System Tools"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop.ini\n0x000000003e919910      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Cookie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("AppData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Roaming"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Start Menu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Programs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Accessories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop.ini\n0x000000003e93f578      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("ProgramData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Start Menu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Programs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Accessories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Tablet PC"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop.ini\n0x000000003e95bc98      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("ProgramData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Start Menu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Programs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Maintenance"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop.ini\n0x000000003eb33bc8      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Cookie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop\n0x000000003f3f55c0      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Public"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop\n0x000000003f9871d8      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("root"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("desktop.ini\n0x000000003fca7630      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--rwd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Cookie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("AppData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Roaming"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("SendTo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Desktop.ini\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br")])]),s("p",[t._v("这是查看raw文件中的桌面文件，没有得到有用的信息，只得知了是Cookie用户")]),t._v(" "),s("p",[s("code",[t._v("查看一下他的电脑截图")])]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("volatility "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" Cookie.rwa "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--profile")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Win7SP1x86 screenshot --dump-dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("./\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-3.jpg",alt:""}})]),t._v(" "),s("p",[t._v("只得到了一个页面信息，提示正在使用的进程是DUMpit.exe")]),t._v(" "),s("p",[s("code",[t._v("看一下用户信息")])]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("volatility "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" Cookie.raw "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--profile")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Win7SP1x86 printkey "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-K")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SAM\\Domains\\Account\\Users\\Names"')]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-4.jpg",alt:""}})]),t._v(" "),s("p",[t._v("只有基本的几个用户")]),t._v(" "),s("p",[s("code",[t._v("看一下他的命令行输出了什么")])]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("volatility "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" Cookie.raw "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--profile")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Win7SP1x86 cmdline\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-5.jpg",alt:""}})]),t._v(" "),s("p",[t._v("可以看到一些cmd信息和进程号")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('Volatility Foundation Volatility Framework 2.6\n************************************************************************\nSystem pid:      4\n************************************************************************\nsmss.exe pid:    272\nCommand line : \\SystemRoot\\System32\\smss.exe\n************************************************************************\ncsrss.exe pid:    360\nCommand line : %SystemRoot%\\system32\\csrss.exe ObjectDirectory=\\Windows SharedSection=1024,12288,512 Windows=On SubSystemType=Windows ServerDll=basesrv,1 ServerDll=winsrv:UserServerDllInitialization,3 ServerDll=winsrv:ConServerDllInitialization,2 ServerDll=sxssrv,4 ProfileControl=Off MaxRequestThreads=16\n************************************************************************\nwininit.exe pid:    412\nCommand line : wininit.exe\n************************************************************************\ncsrss.exe pid:    420\nCommand line : %SystemRoot%\\system32\\csrss.exe ObjectDirectory=\\Windows SharedSection=1024,12288,512 Windows=On SubSystemType=Windows ServerDll=basesrv,1 ServerDll=winsrv:UserServerDllInitialization,3 ServerDll=winsrv:ConServerDllInitialization,2 ServerDll=sxssrv,4 ProfileControl=Off MaxRequestThreads=16\n************************************************************************\nwinlogon.exe pid:    480\nCommand line : winlogon.exe\n************************************************************************\nservices.exe pid:    520\nCommand line : C:\\Windows\\system32\\services.exe\n************************************************************************\nlsass.exe pid:    528\nCommand line : C:\\Windows\\system32\\lsass.exe\n************************************************************************\nlsm.exe pid:    536\nCommand line : C:\\Windows\\system32\\lsm.exe\n************************************************************************\nsvchost.exe pid:    636\nCommand line : C:\\Windows\\system32\\svchost.exe -k DcomLaunch\n************************************************************************\nsvchost.exe pid:    716\nCommand line : C:\\Windows\\system32\\svchost.exe -k RPCSS\n************************************************************************\nsvchost.exe pid:    808\nCommand line : C:\\Windows\\System32\\svchost.exe -k LocalServiceNetworkRestricted\n************************************************************************\nsvchost.exe pid:    844\nCommand line : C:\\Windows\\System32\\svchost.exe -k LocalSystemNetworkRestricted\n************************************************************************\nsvchost.exe pid:    876\nCommand line : C:\\Windows\\system32\\svchost.exe -k netsvcs\n************************************************************************\naudiodg.exe pid:    956\nCommand line : C:\\Windows\\system32\\AUDIODG.EXE 0x2e8\n************************************************************************\nsvchost.exe pid:   1036\nCommand line : C:\\Windows\\system32\\svchost.exe -k LocalService\n************************************************************************\nsvchost.exe pid:   1132\nCommand line : C:\\Windows\\system32\\svchost.exe -k NetworkService\n************************************************************************\nspoolsv.exe pid:   1280\nCommand line : C:\\Windows\\System32\\spoolsv.exe\n************************************************************************\nsvchost.exe pid:   1376\nCommand line : C:\\Windows\\system32\\svchost.exe -k LocalServiceNoNetwork\n************************************************************************\nVGAuthService. pid:   1560\nCommand line : "C:\\Program Files\\VMware\\VMware Tools\\VMware VGAuth\\VGAuthService.exe"\n************************************************************************\nvmtoolsd.exe pid:   1584\nCommand line : "C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe"\n************************************************************************\nsvchost.exe pid:   1824\nCommand line : C:\\Windows\\system32\\svchost.exe -k bthsvcs\n************************************************************************\ndllhost.exe pid:    128\nCommand line : C:\\Windows\\system32\\dllhost.exe /Processid:{02D4B3F1-FD88-11D1-960D-00805FC79235}\n************************************************************************\nmsdtc.exe pid:    596\nCommand line : C:\\Windows\\System32\\msdtc.exe\n************************************************************************\nWmiPrvSE.exe pid:    920\nCommand line : C:\\Windows\\system32\\wbem\\wmiprvse.exe\n************************************************************************\ntaskhost.exe pid:   2096\nCommand line : "taskhost.exe"\n************************************************************************\ndwm.exe pid:   2188\nCommand line : "C:\\Windows\\system32\\Dwm.exe"\n************************************************************************\nexplorer.exe pid:   2216\nCommand line : C:\\Windows\\Explorer.EXE\n************************************************************************\nvm3dservice.ex pid:   2404\nCommand line : "C:\\Windows\\System32\\vm3dservice.exe" -u\n************************************************************************\nvmtoolsd.exe pid:   2412\nCommand line : "C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe" -n vmusr\n************************************************************************\nSearchIndexer. pid:   2584\nCommand line : C:\\Windows\\system32\\SearchIndexer.exe /Embedding\n************************************************************************\nWmiPrvSE.exe pid:   2764\nCommand line : C:\\Windows\\system32\\wbem\\wmiprvse.exe\n************************************************************************\nsvchost.exe pid:   3224\nCommand line : C:\\Windows\\system32\\svchost.exe -k LocalServiceAndNoImpersonation\n************************************************************************\nsppsvc.exe pid:   3272\nCommand line : C:\\Windows\\system32\\sppsvc.exe\n************************************************************************\nsvchost.exe pid:   3344\nCommand line : C:\\Windows\\System32\\svchost.exe -k secsvcs\n************************************************************************\ntaskhost.exe pid:   2924\nCommand line : taskhost.exe $(Arg0)\n************************************************************************\nSearchProtocol pid:   3520\nCommand line : "C:\\Windows\\system32\\SearchProtocolHost.exe" Global\\UsGthrFltPipeMssGthrPipe5_ Global\\UsGthrCtrlFltPipeMssGthrPipe5 1 -2147483646 "Software\\Microsoft\\Windows Search" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT; MS Search 4.0 Robot)" "C:\\ProgramData\\Microsoft\\Search\\Data\\Temp\\usgthrsvc" "DownLevelDaemon" \n************************************************************************\nSearchFilterHo pid:   2692\nCommand line : "C:\\Windows\\system32\\SearchFilterHost.exe" 0 532 536 544 65536 540 \n************************************************************************\nDumpIt.exe pid:   3632\nCommand line : "C:\\Users\\Cookie\\Desktop\\DumpIt.exe" \n************************************************************************\nconhost.exe pid:   1684\nCommand line : \\??\\C:\\Windows\\system32\\conhost.exe\n************************************************************************\ndllhost.exe pid:   3552\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br"),s("span",{staticClass:"line-number"},[t._v("48")]),s("br"),s("span",{staticClass:"line-number"},[t._v("49")]),s("br"),s("span",{staticClass:"line-number"},[t._v("50")]),s("br"),s("span",{staticClass:"line-number"},[t._v("51")]),s("br"),s("span",{staticClass:"line-number"},[t._v("52")]),s("br"),s("span",{staticClass:"line-number"},[t._v("53")]),s("br"),s("span",{staticClass:"line-number"},[t._v("54")]),s("br"),s("span",{staticClass:"line-number"},[t._v("55")]),s("br"),s("span",{staticClass:"line-number"},[t._v("56")]),s("br"),s("span",{staticClass:"line-number"},[t._v("57")]),s("br"),s("span",{staticClass:"line-number"},[t._v("58")]),s("br"),s("span",{staticClass:"line-number"},[t._v("59")]),s("br"),s("span",{staticClass:"line-number"},[t._v("60")]),s("br"),s("span",{staticClass:"line-number"},[t._v("61")]),s("br"),s("span",{staticClass:"line-number"},[t._v("62")]),s("br"),s("span",{staticClass:"line-number"},[t._v("63")]),s("br"),s("span",{staticClass:"line-number"},[t._v("64")]),s("br"),s("span",{staticClass:"line-number"},[t._v("65")]),s("br"),s("span",{staticClass:"line-number"},[t._v("66")]),s("br"),s("span",{staticClass:"line-number"},[t._v("67")]),s("br"),s("span",{staticClass:"line-number"},[t._v("68")]),s("br"),s("span",{staticClass:"line-number"},[t._v("69")]),s("br"),s("span",{staticClass:"line-number"},[t._v("70")]),s("br"),s("span",{staticClass:"line-number"},[t._v("71")]),s("br"),s("span",{staticClass:"line-number"},[t._v("72")]),s("br"),s("span",{staticClass:"line-number"},[t._v("73")]),s("br"),s("span",{staticClass:"line-number"},[t._v("74")]),s("br"),s("span",{staticClass:"line-number"},[t._v("75")]),s("br"),s("span",{staticClass:"line-number"},[t._v("76")]),s("br"),s("span",{staticClass:"line-number"},[t._v("77")]),s("br"),s("span",{staticClass:"line-number"},[t._v("78")]),s("br"),s("span",{staticClass:"line-number"},[t._v("79")]),s("br"),s("span",{staticClass:"line-number"},[t._v("80")]),s("br"),s("span",{staticClass:"line-number"},[t._v("81")]),s("br"),s("span",{staticClass:"line-number"},[t._v("82")]),s("br"),s("span",{staticClass:"line-number"},[t._v("83")]),s("br"),s("span",{staticClass:"line-number"},[t._v("84")]),s("br"),s("span",{staticClass:"line-number"},[t._v("85")]),s("br"),s("span",{staticClass:"line-number"},[t._v("86")]),s("br"),s("span",{staticClass:"line-number"},[t._v("87")]),s("br"),s("span",{staticClass:"line-number"},[t._v("88")]),s("br"),s("span",{staticClass:"line-number"},[t._v("89")]),s("br"),s("span",{staticClass:"line-number"},[t._v("90")]),s("br"),s("span",{staticClass:"line-number"},[t._v("91")]),s("br"),s("span",{staticClass:"line-number"},[t._v("92")]),s("br"),s("span",{staticClass:"line-number"},[t._v("93")]),s("br"),s("span",{staticClass:"line-number"},[t._v("94")]),s("br"),s("span",{staticClass:"line-number"},[t._v("95")]),s("br"),s("span",{staticClass:"line-number"},[t._v("96")]),s("br"),s("span",{staticClass:"line-number"},[t._v("97")]),s("br"),s("span",{staticClass:"line-number"},[t._v("98")]),s("br"),s("span",{staticClass:"line-number"},[t._v("99")]),s("br"),s("span",{staticClass:"line-number"},[t._v("100")]),s("br"),s("span",{staticClass:"line-number"},[t._v("101")]),s("br"),s("span",{staticClass:"line-number"},[t._v("102")]),s("br"),s("span",{staticClass:"line-number"},[t._v("103")]),s("br"),s("span",{staticClass:"line-number"},[t._v("104")]),s("br"),s("span",{staticClass:"line-number"},[t._v("105")]),s("br"),s("span",{staticClass:"line-number"},[t._v("106")]),s("br"),s("span",{staticClass:"line-number"},[t._v("107")]),s("br"),s("span",{staticClass:"line-number"},[t._v("108")]),s("br"),s("span",{staticClass:"line-number"},[t._v("109")]),s("br"),s("span",{staticClass:"line-number"},[t._v("110")]),s("br"),s("span",{staticClass:"line-number"},[t._v("111")]),s("br"),s("span",{staticClass:"line-number"},[t._v("112")]),s("br"),s("span",{staticClass:"line-number"},[t._v("113")]),s("br"),s("span",{staticClass:"line-number"},[t._v("114")]),s("br"),s("span",{staticClass:"line-number"},[t._v("115")]),s("br"),s("span",{staticClass:"line-number"},[t._v("116")]),s("br"),s("span",{staticClass:"line-number"},[t._v("117")]),s("br"),s("span",{staticClass:"line-number"},[t._v("118")]),s("br"),s("span",{staticClass:"line-number"},[t._v("119")]),s("br"),s("span",{staticClass:"line-number"},[t._v("120")]),s("br"),s("span",{staticClass:"line-number"},[t._v("121")]),s("br"),s("span",{staticClass:"line-number"},[t._v("122")]),s("br")])]),s("p",[t._v("也没有得到关键的信息")]),t._v(" "),s("p",[s("code",[t._v("看一下连接过的网络")])]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("volatility "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" Cookie.raw "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--profile")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Win7SP1x86 netscan\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-7.jpg",alt:""}})]),t._v(" "),s("p",[t._v("看到在3分钟之后是未知的，回到进程查看一下他干了什么")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" volatility "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" Cookie.raw "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--profile")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Win7SP1x86 pslist\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-8.jpg",alt:""}})]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("0x87da3d40 sppsvc.exe             3272    520      4      159      0      0 2020-02-11 12:03:00 UTC+0000                                 \n0x87cdbd40 svchost.exe            3344    520      9      310      0      0 2020-02-11 12:03:00 UTC+0000                                 \n0x87d65030 taskhost.exe           2924    520      8      181      0      0 2020-02-11 12:09:55 UTC+0000                                 \n0x87f2a550 SearchProtocol         3520   2584      7      320      0      0 2020-02-11 12:10:35 UTC+0000           \n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("这一段3~9分钟之间发生了一些事情让出题人等待了一下，上网查一下这些进程的含义以及使用的用途")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-9.jpg",alt:""}})]),t._v(" "),s("p",[t._v("把这个位置的进程dump出来加以分析一下")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("volatility -f Cookie.raw --profile=Win7SP1x86 memdump -p 2924 --dump-dir=./\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("C:\\home\\kali\\桌面> volatility -f Cookie.raw --profile=Win7SP1x86 memdump -p 2924 --dump-dir=./\nVolatility Foundation Volatility Framework 2.6\n************************************************************************\nWriting taskhost.exe [  2924] to 2924.dmp\n\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[t._v("得到一个2924.dmp文件")]),t._v(" "),s("p",[s("code",[t._v("关键字文件查找")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("strings 2924.dmp | grep flag{ ;strings 2924.dmp | grep DASCTF{ ;strings 2924.dmp | grep ctf{\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('C:\\home\\kali\\桌面> strings 2924.dmp | grep flag{ ;strings 2924.dmp | grep DASCTF{ ;strings 2924.dmp | grep ctf{\n$value = "flag{528c8870778d2336fdf512652b74a8aa}";\n\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[t._v("得到flag")]),t._v(" "),s("p",[t._v("看一下文件里面是什么")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-10.jpg",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"v-n2020-公开赛-内存取证"}},[t._v("[V&N2020 公开赛]内存取证 "),s("a",{staticClass:"header-anchor",attrs:{href:"#v-n2020-公开赛-内存取证"}},[t._v("#")])]),t._v(" "),s("h4",{attrs:{id:"查看基本文件架构"}},[t._v("查看基本文件架构 "),s("a",{staticClass:"header-anchor",attrs:{href:"#查看基本文件架构"}},[t._v("#")])]),t._v(" "),s("p",[s("img",{attrs:{src:"http://peiqi.tech/buuctf/misc/buuctf-misc-51-1.png",alt:""}})]),t._v(" "),s("h4",{attrs:{id:"获取有利信息"}},[t._v("获取有利信息 "),s("a",{staticClass:"header-anchor",attrs:{href:"#获取有利信息"}},[t._v("#")])]),t._v(" "),s("p",[t._v("扫描 记事本文件")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("kali@kali:~/桌面$ volatility "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" mem.raw "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--profile")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Win7SP0x86 filescan "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" not                                                                                                                                                           \nVolatility Foundation Volatility Framework "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.6")]),t._v("                                                                                                                                                                                             \n0x000000001de89cb8      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" R--r-d "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HarddiskVolume2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("System32"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("notepad.exe\n\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("dump进程查看文件，发现文件可能被删除")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://peiqi.tech/buuctf/misc/buuctf-misc-51-2.png",alt:""}})]),t._v(" "),s("h4",{attrs:{id:"删除数据恢复"}},[t._v("删除数据恢复 "),s("a",{staticClass:"header-anchor",attrs:{href:"#删除数据恢复"}},[t._v("#")])]),t._v(" "),s("p",[t._v("使用命令恢复数据")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://peiqi.tech/buuctf/misc/buuctf-misc-51-3.png",alt:""}})]),t._v(" "),s("p",[t._v("得到百度网盘链接和提取码，下载下来一个加密文件")]),t._v(" "),s("p",[t._v("寻找加密进程")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://peiqi.tech/buuctf/misc/buuctf-misc-51-4.png",alt:""}})]),t._v(" "),s("p",[t._v("dump进程下来 使用EFDD解密vol文件")]),t._v(" "),s("p",[s("code",[t._v("得到密码:uOjFdKu1jsbWI8N51jsbWI8N5")])]),t._v(" "),s("p",[t._v("再使用得到的密码TrueCrypt挂载上去解密")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://peiqi.tech/buuctf/misc/buuctf-misc-51-6.png",alt:""}})]),t._v(" "),s("p",[t._v("得到一个加密的flag压缩包")]),t._v(" "),s("h4",{attrs:{id:"gimp还原"}},[t._v("GIMP还原 "),s("a",{staticClass:"header-anchor",attrs:{href:"#gimp还原"}},[t._v("#")])]),t._v(" "),s("p",[t._v("把 mspaint.exe (pid 2648) dump下来，使用GIMP还原")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://peiqi.tech/buuctf/misc/buuctf-misc-51-5.png",alt:""}})]),t._v(" "),s("p",[s("code",[t._v("得到密码 :1YxfCQ6goYBD6Q")])]),t._v(" "),s("p",[t._v("打开加密zip文件得到flag")]),t._v(" "),s("p",[s("code",[t._v("RoarCTF{wm_D0uB1e_TC-cRypt}")])])])}),[],!1,null,null,null);s.default=e.exports}}]);